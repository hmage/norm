#!/bin/bash

depends_on xz liblzo
depends_on liblz4
depends_on zstd

[[ $OSTYPE != *darwin* ]] && depends_on zlib ## osx gurantees to provide one, opportunistic linking on other systems

fetch_source https://github.com/plougher/squashfs-tools/archive/refs/tags/4.5.1.tar.gz 3dc0a4d88b0a40f1537cea5e50371c1be0bb590f

do_unpack
SRCDIR="$SRCDIR/squashfs-tools"
pushd_src
do_make XZ_SUPPORT=1 LZO_SUPPORT=1 LZ4_SUPPORT=1 ZSTD_SUPPORT=1 LZMA_XZ_SUPPORT=1 XATTR_SUPPORT=1
do_install INSTALL_PREFIX="$PREFIX"
popd_src
