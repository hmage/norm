#!/bin/bash

CONFFLAGS=(
--disable-makeinstall-chown ## otherwise it tries to chown root:root which we don't have permissions for
--with-bashcompletiondir="$PREFIX/etc/bash_completion.d" ## otherwise tries to overwrite system bash-completion if it's installed
--without-ncurses  ## opportunistic linking, though the only tool that has UI is cfdisk
--without-ncursesw ## opportunistic linking, though the only tool that has UI is cfdisk
--disable-cramfs ## cramfs is not widely used, but it has zlib dependency
)

OURNAME=`basename "${BASH_SOURCE[0]}"` ## get our filename, it could be a library name
[[ $OURNAME == lib* ]] && CONFFLAGS+=(--without-python --disable-all-programs --enable-$OURNAME) ## if it's a library, disable building any binaries, and then enable building only specific library
[[ $OURNAME == libmount ]] && CONFFLAGS+=(--enable-libblkid) ## otherwise building libmount fails
[[ $OURNAME == libmount ]] && CONFFLAGS+=(--enable-libuuid)  ## otherwise building glib fails
[[ $OSTYPE == *darwin* ]] && CONFFLAGS+=(--disable-ipcrm --disable-ipcs) ## does not build on darwin
[[ $OSTYPE == *darwin* ]] && CONFFLAGS+=(--disable-libuuid) ## breaks builds of other software on darwin, like ffmpeg

fetch_source https://www.kernel.org/pub/linux/utils/util-linux/v2.33/util-linux-2.33.1.tar.xz f57232d9594d23e7c20b5728b24bf4e5d977accc

do_unpack_compile "${CONFFLAGS[@]}"
