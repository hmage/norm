#!/bin/bash

fetch_source http://ftpmirror.gnu.org/gettext/gettext-1.0.tar.xz 19a8dc3889d465325aa5e7a3106f0a34056249b0

CONFFLAGS=(
--without-emacs  ## build failure on debian 11 with emacs installed
--disable-java   ## save time on building something that is barely used
--disable-curses ## save time on building something that is barely used

--with-included-libunistring ## need only a small subset of unistring
)

do_unpack
pushd_src
ac_cv_prog_cc_c23=no \
am_cv_func_iconv=yes \
am_cv_func_iconv_works=yes \
CFLAGS="${CFLAGS/-Ofast/}" \
CXXFLAGS="${CXXFLAGS/-Ofast/}" \
LIBS="-liconv $LIBS" \
do_configure "${CONFFLAGS[@]}"
do_make_and_install
popd_src
