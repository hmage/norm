#!/bin/bash

needs_tool python ## for building
depends_on pixman
depends_on glib
depends_on libsdl2 ## for GUI
needs_tool ninja ## for building

fetch_source https://download.qemu.org/qemu-6.2.0.tar.xz 68cd61a466170115b88817e2d52db2cd7a92f43a

CONFFLAGS=(
--target-list=x86_64-softmmu ## if you need anything else, change this, optionally make a pull request or fill an issue ^.^
--disable-auth-pam ## opportunistic linking with libpam
)

## fix build failure with error "pragma STDC FENV_ACCESS ON is illegal when precise is disabled"
CFLAGS="${CFLAGS/-Ofast/}" \
CXXFLAGS="${CXXFLAGS/-Ofast/}" \
do_unpack_compile "${CONFFLAGS[@]}"
