#!/bin/bash

needs_tool python ## for building
depends_on pixman
depends_on glib
depends_on libsdl2 ## for GUI
needs_tool ninja ## for building

fetch_source https://download.qemu.org/qemu-7.0.0.tar.xz c3fd2403106c33d0470bc9ba4fb4b946c0402248

CONFFLAGS=(
--target-list=x86_64-softmmu ## if you need anything else, change this, optionally make a pull request or fill an issue ^.^
--disable-auth-pam ## opportunistic linking with libpam
)

## fix build failure with error "pragma STDC FENV_ACCESS ON is illegal when precise is disabled"
CFLAGS="${CFLAGS/-Ofast/}" \
CXXFLAGS="${CXXFLAGS/-Ofast/}" \
do_unpack_compile "${CONFFLAGS[@]}"
